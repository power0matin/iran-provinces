<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- عنوان و توضیح پویا (JS مقداردهی کند) -->
  <title id="metaTitle">استان | معرفی و اطلاعات</title>
  <meta id="metaDescription" name="description"
    content="معرفی استان: تاریخچه، جمعیت، مساحت، شهرستان‌ها، شهرها و دیدنی‌ها." />
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
  <link id="canonicalLink" rel="canonical" href="https://power0matin.github.io/iran-provinces/province.html" />

  <!-- Open Graph (پویا) -->
  <meta property="og:type" content="article" />
  <meta property="og:site_name" content="استان‌های ایران" />
  <meta property="og:locale" content="fa_IR" />
  <meta id="ogTitle" property="og:title" content="استان | معرفی و اطلاعات" />
  <meta id="ogDescription" property="og:description" content="نمای کلی استان، تقسیمات و جاذبه‌ها." />
  <meta id="ogUrl" property="og:url" content="https://power0matin.github.io/iran-provinces/province.html" />
  <meta id="ogImage" property="og:image" content="https://power0matin.github.io/iran-provinces/assets/iran-map.png" />
  <meta id="ogImageAlt" property="og:image:alt" content="نمایی از استان" />

  <!-- Twitter (پویا) -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta id="twTitle" name="twitter:title" content="استان | معرفی و اطلاعات" />
  <meta id="twDesc" name="twitter:description" content="نمای کلی استان، تقسیمات و جاذبه‌ها." />
  <meta id="twImage" name="twitter:image" content="https://power0matin.github.io/iran-provinces/assets/iran-map.png" />

  <!-- Structured Data (پویا) -->
  <script id="provinceLd" type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Place",
    "name": "استان",
    "image": "https://power0matin.github.io/iran-provinces/assets/iran-map.png",
    "address": { "@type": "PostalAddress", "addressCountry": "IR" },
    "url": "https://power0matin.github.io/iran-provinces/province.html",
    "inLanguage": "fa"
  }
  </script>

  <!-- PWA / Theme -->
  <meta name="theme-color" content="#0ea5e9" />
  <link rel="manifest" href="/manifest.json" />
  <link rel="icon" href="/icons/favicon.ico" sizes="any" />
  <link rel="icon" type="image/svg+xml" href="/icons/icon.svg" />
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />

  <!-- Performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
  <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600;700&display=swap" rel="stylesheet" />

  <!-- Styles -->
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/components.css" />
  <link rel="stylesheet" href="css/responsive.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
</head>


<body class="theme-auto">
  <!-- Header -->
  <header class="site-header" data-sticky>
    <div class="topbar container">
      <!-- برند -->
      <a class="brand" href="index.html" aria-label="خانه">
        <span class="brand-icon"><i class="fa-solid fa-map-location-dot"></i></span>
        <strong class="brand-text" data-i18n="brand.title">استان‌های ایران</strong>
      </a>

      <!-- Search -->
      <form id="siteSearch" class="searchbox" role="search" aria-label="Search provinces">
        <label for="searchInput" class="sr-only">Search</label>
        <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>

        <input id="searchInput" type="search" name="q" inputmode="search" autocomplete="off" enterkeyhint="search"
          spellcheck="false" dir="auto" data-i18n-placeholder="search.placeholder" placeholder="جستجوی استان…"
          aria-controls="results" />

        <button type="button" class="sb-clear" id="searchClear" hidden aria-label="Clear search">
          <i class="fa-solid fa-xmark" aria-hidden="true"></i>
        </button>

        <kbd class="kbd" aria-hidden="true">/</kbd>
      </form>


      <!-- اکشن‌ها -->
      <div class="actions">
        <div class="capsule">
          <!-- سوییچ تم -->
          <label class="switch" title="Theme">
            <input type="checkbox" id="darkModeToggle" aria-label="Theme" />
            <span class="slider">
              <i class="sun fa-solid fa-sun"></i>
              <i class="moon fa-solid fa-moon"></i>
            </span>
          </label>

          <!-- زبان -->
          <button id="langToggle" class="capsule-btn" aria-label="Language">
            <i class="fa-solid fa-language"></i>
            <span class="hide-sm" data-i18n="header.lang">زبان</span>
          </button>
        </div>
      </div>
    </div>

    <!-- ناوبری: دقیــقاً زیر متن برند و هم‌تراز با آن -->
    <nav id="mainNav" class="main-nav" aria-label="ناوبری اصلی">
      <div class="container nav-inner">
        <a href="index.html" class="nav-link"><i class="fa-solid fa-house"></i><span
            data-i18n="nav.home">خانه</span></a>
        <a href="about.html" class="nav-link"><i class="fa-solid fa-circle-info"></i><span
            data-i18n="nav.about">درباره</span></a>
        <a href="contact.html" class="nav-link"><i class="fa-solid fa-envelope"></i><span
            data-i18n="nav.contact">تماس</span></a>
      </div>
    </nav>
    <div class="nav-backdrop" id="navBackdrop"></div>
  </header>

  <!-- Main -->
  <main class="container">
    <section class="card fade-in-up">
      <div class="card-header">
        <div class="chips">
          <span id="chipCapital" class="chip"></span>
          <span id="chipPopulation" class="chip"></span>
          <span id="chipArea" class="chip"></span>
        </div>

        <div class="tabs" role="tablist" aria-label="Tabs">
          <button id="tab-intro" class="tab active" data-tab="intro" data-i18n="province.intro" role="tab" type="button"
            aria-selected="true" aria-controls="panel-intro">
            معرفی
          </button>
          <button id="tab-counties" class="tab" data-tab="counties" data-i18n="province.counties" role="tab"
            type="button" aria-selected="false" aria-controls="panel-counties">
            شهرستان‌ها
          </button>
          <button id="tab-cities" class="tab" data-tab="cities" data-i18n="province.cities" role="tab" type="button"
            aria-selected="false" aria-controls="panel-cities">
            شهرها
          </button>
          <button id="tab-attractions" class="tab" data-tab="attractions" data-i18n="province.attractions" role="tab"
            type="button" aria-selected="false" aria-controls="panel-attractions">
            دیدنی‌ها
          </button>
        </div>
      </div>

      <div class="card-body">
        <!-- معرفی -->
        <div id="panel-intro" class="tab-panel active" role="tabpanel" tabindex="0" aria-labelledby="tab-intro">
          <h2 id="introTitle" data-i18n="province.aboutTitle">درباره استان</h2>
          <p id="introText" class="muted"></p>
          <figure class="hero-wrap">
            <img id="heroImage" src="" alt="" class="hero" loading="lazy" decoding="async" fetchpriority="low"
              sizes="(max-width: 900px) 100vw, 960px" />
          </figure>
        </div>

        <!-- شهرستان‌ها -->
        <div id="panel-counties" class="tab-panel" role="tabpanel">
          <div id="countiesAccordion" class="accordion"></div>
        </div>

        <!-- شهرها -->
        <div id="panel-cities" class="tab-panel" role="tabpanel">
          <ul id="citiesList" class="tiles"></ul>
        </div>

        <!-- دیدنی‌ها -->
        <div id="panel-attractions" class="tab-panel" role="tabpanel">
          <ul id="attractionsList" class="tiles"></ul>
        </div>
      </div>

      <div class="card-footer">
        <span id="resultCount" class="muted"></span>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="footer-inner">
      <p>
        © <span id="year"></span>
        <span data-i18n="footer.rights">تمامی حقوق محفوظ است.</span>
      </p>
    </div>
  </footer>

  <!-- Scripts: i18n & theme must load BEFORE province.js -->
  <script src="js/i18n.js" defer></script>
  <script src="js/darkMode.js" defer></script>
  <script src="js/province.js" defer></script>

  <script src="js/site.js" defer></script>
  <script src="js/app.js" defer></script>

  <!-- Leaflet -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin="" defer></script>
  <script src="js/map.js" defer></script>
  <script src="js/nav.js" defer></script>
  <script src="js/search-global.js" defer></script>
  <script src="js/theme-sync.js" defer></script>
  <script>
    (function () {
      const mq = window.matchMedia('(max-width: 700px)');
      const form = document.getElementById('siteSearch');
      const input = document.getElementById('searchInput');
      const clearBtn = document.getElementById('searchClear');
      const icon = form?.querySelector('.fa-magnifying-glass');

      if (!form || !icon || !input) return;

      function openSearch() {
        form.classList.add('searchbox--open');
        form.setAttribute('aria-expanded', 'true');
        // defer focus so CSS can apply first
        setTimeout(() => input.focus(), 0);
      }
      function closeSearch() {
        if (!mq.matches) return;               // desktop unaffected
        if (input.value.trim()) return;        // don't close if has text
        form.classList.remove('searchbox--open');
        form.setAttribute('aria-expanded', 'false');
      }

      // Tap on icon opens (only on mobile)
      icon.addEventListener('click', (e) => {
        if (mq.matches && !form.classList.contains('searchbox--open')) {
          e.preventDefault();
          openSearch();
        }
      });

      // ESC closes when empty
      form.addEventListener('keydown', (e) => {
        if (mq.matches && e.key === 'Escape') {
          input.value = '';
          closeSearch();
        }
      });

      // Clear button
      clearBtn?.addEventListener('click', () => {
        input.value = '';
        input.dispatchEvent(new Event('input', { bubbles: true }));
        closeSearch();
      });

      // Click outside closes (وقتی خالی است)
      document.addEventListener('click', (e) => {
        if (!mq.matches) return;
        if (!form.classList.contains('searchbox--open')) return;
        if (!form.contains(e.target)) closeSearch();
      });

      // Blur closes اگر خالی باشد
      input.addEventListener('blur', closeSearch);

      // Ensure proper state on resize
      mq.addEventListener?.('change', () => {
        form.classList.remove('searchbox--open');
        form.removeAttribute('aria-expanded');
      });
    })();
  </script>

</body>

</html>