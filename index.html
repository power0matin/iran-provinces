<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>استان‌های ایران | جستجو و نقشه تعاملی</title>
  <meta name="description"
    content="معرفی جامع استان‌های ایران با جستجوی سریع، نقشه تعاملی، حالت تیره/روشن و پشتیبانی چندزبانه." />
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
  <link rel="canonical" href="https://your-domain.ir/" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="استان‌های ایران" />
  <meta property="og:locale" content="fa_IR" />
  <meta property="og:title" content="استان‌های ایران | جستجو و نقشه تعاملی" />
  <meta property="og:description" content="فهرست کامل استان‌ها، جستجو و نقشه تعاملی برای مرور سریع اطلاعات هر استان." />
  <meta property="og:url" content="https://power0matin.github.io/iran-provinces/" />
  <meta property="og:image" content="https://power0matin.github.io/iran-provinces/assets/iran-map.png" />
  <meta property="og:image:alt" content="نقشه ایران - استان‌ها" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="استان‌های ایران | جستجو و نقشه تعاملی" />
  <meta name="twitter:description" content="مرجع سبک و سریع برای مرور استان‌های ایران." />
  <meta name="twitter:image" content="https://your-domain.ir/assets/iran-map.png" />

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "استان‌های ایران",
    "url": "https://your-domain.ir/",
    "inLanguage": "fa",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://your-domain.ir/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>

  <!-- PWA / Theme -->
  <meta name="theme-color" content="#0ea5e9" />
  <link rel="manifest" href="/manifest.json" />
  <link rel="icon" href="/icons/favicon.ico" sizes="any" />
  <link rel="icon" type="image/svg+xml" href="/icons/icon.svg" />
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />

  <!-- Performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
  <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin />
  <link rel="preconnect" href="https://unpkg.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600;700&display=swap" rel="stylesheet" />

  <!-- Styles -->
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/components.css" />
  <link rel="stylesheet" href="css/responsive.css" />
  <link rel="stylesheet" href="css/map.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
</head>

<body class="theme-auto">
  <!-- Header -->
  <header class="site-header" data-sticky>
    <div class="topbar container">
      <!-- برند -->
      <a class="brand" href="index.html" aria-label="خانه">
        <span class="brand-icon"><i class="fa-solid fa-map-location-dot"></i></span>
        <strong class="brand-text" data-i18n="brand.title">استان‌های ایران</strong>
      </a>

      <!-- Search -->
      <form id="siteSearch" class="searchbox" role="search" aria-label="Search provinces">
        <label for="searchInput" class="sr-only">Search</label>
        <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>

        <input id="searchInput" type="search" name="q" inputmode="search" autocomplete="off" enterkeyhint="search"
          spellcheck="false" dir="auto" data-i18n-placeholder="search.placeholder" placeholder="جستجوی استان…"
          aria-controls="results" />

        <button type="button" class="sb-clear" id="searchClear" hidden aria-label="Clear search">
          <i class="fa-solid fa-xmark" aria-hidden="true"></i>
        </button>

        <kbd class="kbd" aria-hidden="true">/</kbd>
      </form>


      <!-- اکشن‌ها -->
      <div class="actions">
        <div class="capsule">
          <label class="switch" title="Theme">
            <input type="checkbox" id="darkModeToggle" aria-label="Theme" />
            <span class="slider">
              <i class="sun fa-solid fa-sun"></i>
              <i class="moon fa-solid fa-moon"></i>
            </span>
          </label>

          <!-- زبان -->
          <button id="langToggle" class="capsule-btn" aria-label="Language">
            <i class="fa-solid fa-language"></i>
            <span class="hide-sm" data-i18n="header.lang">زبان</span>
          </button>
        </div>

      </div>
    </div>

    <!-- ناوبری: دقیــقاً زیر متن برند و هم‌تراز با آن -->
    <nav id="mainNav" class="main-nav" aria-label="ناوبری اصلی">
      <div class="container nav-inner">
        <a href="index.html" class="nav-link is-active"><i class="fa-solid fa-house"></i><span
            data-i18n="nav.home">خانه</span></a>
        <a href="about.html" class="nav-link"><i class="fa-solid fa-circle-info"></i><span
            data-i18n="nav.about">درباره</span></a>
        <a href="contact.html" class="nav-link"><i class="fa-solid fa-envelope"></i><span
            data-i18n="nav.contact">تماس</span></a>
      </div>
    </nav>
    <div class="nav-backdrop" id="navBackdrop"></div>
  </header>

  <!-- Main -->
  <main class="container">
    <section class="grid">
      <!-- Province list -->
      <section class="card list-card fade-in-up">
        <div class="card-header">
          <div class="card-title">
            <i class="fa-regular fa-rectangle-list"></i>
            <span data-i18n="home.provinces">استان‌ها</span>
          </div>
          <span id="countBadge" class="badge">—</span>
        </div>

        <ul id="provinceList" class="province-list" aria-live="polite"></ul>

        <div class="hint">
          <i class="fa-regular fa-lightbulb"></i>
          <span data-i18n="home.hint">کلید / برای فوکوس جستجو و کلید Esc برای پاک‌سازی.</span>
        </div>
      </section>

      <!-- Interactive map -->
      <section class="card map-card fade-in-up">
        <div class="card-header">
          <div class="card-title">
            <i class="fa-regular fa-compass"></i>
            <span data-i18n="home.map">نقشه تعاملی</span>
          </div>
          <span class="badge" id="mapStatus">Loading…</span>
        </div>

        <div class="card-body">
          <div id="map" class="leaflet-map" aria-label="Iran interactive map"></div>
          <div id="mapTooltip" class="map-tooltip" role="tooltip" aria-hidden="true"></div>
        </div>

        <div class="card-footer">
          <span class="muted" data-i18n="home.mapHint">
            با هاور/تاچ روی هر استان نام آن را ببینید؛ با کلیک وارد صفحه همان
            استان شوید.
          </span>
        </div>
      </section>
    </section>
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="footer-inner">
      <p>
        © <span id="year"></span>
        <span data-i18n="footer.rights">تمامی حقوق محفوظ است.</span> ·
        <span data-i18n="footer.by">طراحی توسط</span>
        <a href="https://github.com/power0matin" target="_blank" rel="noreferrer">powermatin</a>
      </p>
    </div>
    <noscript>JavaScript is required for the interactive map and search.</noscript>
  </footer>

  <!-- Scripts (order matters) -->
  <script src="js/i18n.js" defer></script>
  <script src="js/site.js" defer></script>
  <script src="js/app.js" defer></script>
  <script src="js/darkMode.js" defer></script>
  <script src="js/home.js" defer></script>

  <!-- Leaflet -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin="" defer></script>
  <script src="js/map.js" defer></script>
  <script src="js/nav.js" defer></script>
  <script src="js/search-global.js" defer></script>
  <script src="js/theme-sync.js" defer></script>
  <script>
    (function () {
      const mq = window.matchMedia('(max-width: 700px)');
      const form = document.getElementById('siteSearch');
      const input = document.getElementById('searchInput');
      const clearBtn = document.getElementById('searchClear');
      const icon = form?.querySelector('.fa-magnifying-glass');

      if (!form || !icon || !input) return;

      function openSearch() {
        form.classList.add('searchbox--open');
        form.setAttribute('aria-expanded', 'true');
        // defer focus so CSS can apply first
        setTimeout(() => input.focus(), 0);
      }
      function closeSearch() {
        if (!mq.matches) return;               // desktop unaffected
        if (input.value.trim()) return;        // don't close if has text
        form.classList.remove('searchbox--open');
        form.setAttribute('aria-expanded', 'false');
      }

      // Tap on icon opens (only on mobile)
      icon.addEventListener('click', (e) => {
        if (mq.matches && !form.classList.contains('searchbox--open')) {
          e.preventDefault();
          openSearch();
        }
      });

      // ESC closes when empty
      form.addEventListener('keydown', (e) => {
        if (mq.matches && e.key === 'Escape') {
          input.value = '';
          closeSearch();
        }
      });

      // Clear button
      clearBtn?.addEventListener('click', () => {
        input.value = '';
        input.dispatchEvent(new Event('input', { bubbles: true }));
        closeSearch();
      });

      // Click outside closes (وقتی خالی است)
      document.addEventListener('click', (e) => {
        if (!mq.matches) return;
        if (!form.classList.contains('searchbox--open')) return;
        if (!form.contains(e.target)) closeSearch();
      });

      // Blur closes اگر خالی باشد
      input.addEventListener('blur', closeSearch);

      // Ensure proper state on resize
      mq.addEventListener?.('change', () => {
        form.classList.remove('searchbox--open');
        form.removeAttribute('aria-expanded');
      });
    })();
  </script>

</body>

</html>